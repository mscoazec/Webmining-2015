<!DOCTYPE html>
<html>

<!-- Inspiré de : http://bl.ocks.org/mbostock/2206340 -->

 <head>
    <meta charset="utf-8">
    <style type="text/css">
		
		#map {
			margin-left:50px;
			margin-top:50px
		}

    	.arrondissement {
    		cursor: pointer;
    	}
    	.arrondissement:hover {
			fill: LightSlateGray;
    	}
    </style>
  </head>
  
  <body>
  
  <!-- Notre carte -->
  
  <div id="map"></div>
  
    <script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
    <script type="text/javascript">
    (function() {

		  // Taille
		  var width = 1200;
		  var height = 800;

		  // Objet pour manipuler des données géographiques avec D3.js
		  var path = d3.geo.path();

		  // Propriétés de la projection utilisée (Lambert-93)
		  var projection = d3.geo.conicConformal()
		          .center([2.338477, 48.857391]) // carte centrée sur Paris
		          .scale(400000) // échelle]
		          .translate([width/2, height/2]); // la place au centre

		  path.projection(projection);

		  // Elément SVG à la racine de la div #map
		  var svg = d3.select('#map').append("svg")
		      .attr("width", width)
		      .attr("height", height);

		  // Groupe SVG qui accueillera les arrondissements
		  var deps = svg
		  		.append("g") // group
		        .attr("id", "arrondissements");

		  // Données geoJSON des arrondissements récupérées sur le site de l'IGN
		  d3.json('arrondissements_paris.json', function(req, geojson) {
		  
		    // Bind un élément SVG path pour chaque élément de 'features' du geoJSON
		  	var features = deps
		  			.selectAll("path")
					.data(geojson.features);

			// Couleur de fond de chaque arrondissement
		  	var colorScale = d3.scale.category20c();

		  	// Création d'un élément pour chaque item de 'features' du geoJSON avec les propriétés qui suivent
		  	features.enter()
			  	.append("path")
			  		.attr('class', 'arrondissement')
			        .attr("d", path)
					.attr("fill", 'LightSteelBlue')
					.attr("stroke", 'white')
			        .on('click', clickHandlerZoom); // écoute une action de la souris
					
		  });
		  
		  // Fonction qui permet de changer la couleur de l'arrondissement
		  
		  var centered;
		  
		  function countyClickHandler(d) {
		  
		  };

		  // Fonction qui permet de zoomer sur la carte
		  
		  function clickHandlerZoom(d) {
		  	var x, y, k;

		  	if (d && centered !== d) {
					var centroid = path.centroid(d);
					x = centroid[0];
					y = centroid[1];
					k = 5;
					centered = d;
				} else {
					x = width / 2;
					y = height / 2;
					k = 1;
					centered = null;
				}

				deps.selectAll("path")
					.classed("active", centered && function(d) { return d === centered; });

				var trStr = "translate(" + width / 2 + "," + height / 2 + ")" +
					"scale(" + k + ")translate(" + -x + "," + -y + ")";
				
				deps.transition()
					.duration(2000)
					.attr("transform", trStr);
					
		  };

	}());
    </script>
  </body>
</html>